# 快速连接数据库指南

## 方法一：使用脚本（推荐）

如果已配置好 MySQL 密码，可以运行：

```bash
export MYSQL_PASSWORD="your_password"
./数据库连接脚本.sh
```

## 方法二：手动步骤

### 1. 检查 MySQL 服务

```bash
# 检查 MySQL 是否运行
brew services list | grep mysql

# 如果未运行，启动 MySQL
brew services start mysql
```

### 2. 创建数据库

```bash
mysql -u root -p
```

在 MySQL 命令行中执行：

```sql
CREATE DATABASE IF NOT EXISTS basketball_platform 
CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

SHOW DATABASES;
EXIT;
```

### 3. 配置 .env 文件

确保 `.env` 文件包含：

```env
DATABASE_URL="mysql://root:your_password@localhost:3306/basketball_platform"
JWT_SECRET="basketball-platform-secret-key-2024"
```

**重要**: 将 `your_password` 替换为您的实际 MySQL root 密码

### 4. 生成 Prisma 客户端

```bash
npm run db:generate
```

### 5. 推送数据库模式

```bash
npm run db:push
```

这将根据 `prisma/schema.prisma` 在 MySQL 中创建所有表。

### 6. 验证连接

```bash
# 打开 Prisma Studio 查看数据库
npm run db:studio
```

## 测试连接

运行以下命令测试数据库连接：

```bash
node -e "
const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();
prisma.\$connect()
  .then(() => {
    console.log('✅ 数据库连接成功！');
    prisma.\$disconnect();
  })
  .catch((error) => {
    console.error('❌ 数据库连接失败:', error.message);
    process.exit(1);
  });
"
```

## 常见问题

### 问题1: 连接被拒绝
**解决**: 检查 MySQL 服务是否运行
```bash
brew services start mysql
```

### 问题2: 认证失败
**解决**: 检查用户名和密码是否正确
- 确认 `.env` 中的密码正确
- 尝试使用 MySQL 命令行登录测试

### 问题3: 数据库不存在
**解决**: 手动创建数据库
```sql
CREATE DATABASE basketball_platform;
```

### 问题4: 字符集错误
**解决**: 确保使用 utf8mb4
```sql
ALTER DATABASE basketball_platform CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```
