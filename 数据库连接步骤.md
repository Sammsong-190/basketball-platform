# 数据库连接步骤

## 📊 当前状态

根据检查结果：
- ✅ Prisma 客户端已生成
- ❌ MySQL 服务未运行
- ❌ .env 文件中的 DATABASE_URL 未配置

## 🚀 快速连接步骤

### 步骤 1: 启动 MySQL 服务

```bash
# macOS (使用 Homebrew)
brew services start mysql

# 验证服务运行
brew services list | grep mysql
```

### 步骤 2: 创建数据库

```bash
mysql -u root -p
```

在 MySQL 命令行中执行：

```sql
CREATE DATABASE IF NOT EXISTS basketball_platform 
CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

SHOW DATABASES;
EXIT;
```

### 步骤 3: 配置 .env 文件

在项目根目录的 `.env` 文件中添加或更新：

```env
# MySQL 连接字符串
# 如果 root 没有密码：
DATABASE_URL="mysql://root@localhost:3306/basketball_platform"

# 如果 root 有密码（替换 your_password）：
DATABASE_URL="mysql://root:your_password@localhost:3306/basketball_platform"

# JWT Secret
JWT_SECRET="basketball-platform-secret-key-2024"
```

**重要提示:**
- 如果 MySQL root 用户没有密码，使用: `mysql://root@localhost:3306/basketball_platform`
- 如果有密码，使用: `mysql://root:你的密码@localhost:3306/basketball_platform`

### 步骤 4: 生成 Prisma 客户端（如果还没生成）

```bash
npm run db:generate
```

### 步骤 5: 推送数据库模式

```bash
npm run db:push
```

这将根据 `prisma/schema.prisma` 在 MySQL 中创建所有表。

### 步骤 6: 测试连接

```bash
npm run db:test
```

如果看到 "✅ 数据库连接成功！"，说明连接成功！

## 🎯 一键设置（推荐）

运行自动化脚本：

```bash
./setup-database.sh
```

## 🔍 检查状态

随时运行检查脚本查看当前状态：

```bash
./检查数据库状态.sh
```

## 📚 详细文档

- `完整数据库设置指南.md` - 完整的设置指南和故障排查
- `快速连接数据库.md` - 快速参考
- `MySQL配置说明.md` - MySQL 安装和配置

## ✅ 完成检查清单

完成以下步骤后，数据库就连接好了：

- [ ] MySQL 服务已启动
- [ ] 数据库 `basketball_platform` 已创建
- [ ] `.env` 文件中的 `DATABASE_URL` 已配置
- [ ] Prisma 客户端已生成
- [ ] 数据库模式已推送（`npm run db:push`）
- [ ] 连接测试通过（`npm run db:test`）

## 🆘 遇到问题？

1. **MySQL 服务无法启动**
   - 检查 MySQL 是否已安装
   - 尝试: `mysql.server start`

2. **连接被拒绝**
   - 确保 MySQL 服务正在运行
   - 检查端口是否正确（默认 3306）

3. **认证失败**
   - 检查 `.env` 中的密码是否正确
   - 尝试使用 MySQL 命令行登录测试

4. **数据库不存在**
   - 手动创建数据库（见步骤 2）

完成以上步骤后，您的数据库就配置并连接好了！🎉
